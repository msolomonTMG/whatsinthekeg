<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Whatsinthekeg</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/stylish-portfolio.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">What's in the Keg?</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dropdown <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dropdown <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <!-- Header -->
    <header id="top" class="header">
        <div class="container" style="margin-top:30px;">
        <div class="text-vertical-center">
            <div class="row">
                <div class="col-md-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">Tech</div>
                        <div class="panel-body">

                            <div id="techBeerUpdated" style="display:none;">
                                <div class="row">
                                    <div clas="container">
                                        <div class="col-md-12">
                                            <div class="alert alert-success alert-dismissible" role="alert">
                                                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <strong>Success!</strong> Tech's beer was updated!
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <form class="form-horizontal">
                                <div class="form-group">
                                    <div class="col-xs-12">
                                        <select class="form-control" id="techBeerOptions">
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="panel-footer">
                            <div class="row">
                                <button type="button" class="btn btn-primary" id="updateTechBeer">New Beer for Tech!</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">Edit</div>
                        <div class="panel-body">

                            <div id="editBeerUpdated" style="display:none;">
                                <div class="row">
                                    <div clas="container">
                                        <div class="col-md-12">
                                            <div class="alert alert-success alert-dismissible" role="alert">
                                                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <strong>Success!</strong> Edit's beer was updated!
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <form class="form-horizontal">
                                <div class="form-group">
                                    <div class="col-xs-12">
                                        <select class="form-control" id="editBeerOptions">
                                        </select>
                                    </div>
                                </div>
                            </form>
                            </form>
                        </div>
                        <div class="panel-footer">
                            <div class="row">
                                <button type="button" class="btn btn-primary" id="updateEditBeer">New Beer for Edit!</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-8 col-md-offset-2">
                    <div class="panel panel-default">
                        <div class="panel-heading">Add New Beer</div>
                        <div class="panel-body">

                            <div id="newBeerAdded" style="display:none;">
                                <div class="row">
                                    <div clas="container">
                                        <div class="col-md-12">
                                            <div class="alert alert-success alert-dismissible" role="alert">
                                                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <strong>Success!</strong> New beer was added!
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="newBeerFailed" style="display:none;">
                                <div class="row">
                                    <div clas="container">
                                        <div class="col-md-12">
                                            <div class="alert alert-danger alert-dismissible" role="alert">
                                                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <strong>Shit!</strong> Something went wrong, couldn't save that brew!
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <form class="form-horizontal">
                                <div class="form-group">
                                    <div class="col-xs-6">
                                        <div class="input-group">
                                            <span class="input-group-addon"><i class="fa fa-beer"></i></span>
                                            <input type="text" class="form-control input-lg" id="newBeerName" placeholder="Beer Name">
                                        </div>
                                    </div>
                                    <div class="col-xs-6">
                                        <div class="input-group">
                                            <span class="input-group-addon"><i class="fa fa-camera"></i></span>
                                            <input type="text" class="form-control input-lg" id="newBeerImage" placeholder="Image URL">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-xs-12">
                                        <div class="input-group">
                                            <span class="input-group-addon"><i class="fa fa-globe"></i></span>
                                            <input type="text" class="form-control input-lg" id="newBeerWebsite" placeholder="Beer Website">
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="panel-footer">
                            <div class="row">
                                <button type="button" class="btn btn-success" id="createNewBeer">Add New Beer!</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </header>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script>
    var beers;
    //Get all beers
    $.ajax({
        url: 'http://5c2605d6.ngrok.com/beer',
        type: 'get',
        async: false,
        success: function(data) {
            console.log(data);
            beers = data;
        } 
    });

    //Power dropdowns
    powerOptions(techBeerOptions);
    powerOptions(editBeerOptions);
    function powerOptions(dropdown){
        var i = 0;
        while(i < beers.length){
            var $option = $("<option>", {id: beers[i].id})
            $option.html(beers[i].name);
            addOptionTo(dropdown, $option);
            checkIfCurrent(dropdown, beers[i]);
            //$('#techBeerOptions').append($option);
            //$('#editBeerOptions').append($option);
            i++;
        }
    }
    //Function for adding onto dropdown
    function addOptionTo(location, option){
        $(location).append(option);
        return false;
    }
    //Function for selecting current option by default
    function checkIfCurrent(dropdown, beer){
        if (dropdown == techBeerOptions){
            if(beer.currentTechBeer == "true"){
                $(dropdown).val(beer.name);
            }
        }
        if (dropdown == editBeerOptions){
            if(beer.currentEditBeer == "true"){
                $(dropdown).val(beer.name);
            }
        }
    }


    //Create new beers
    $('#createNewBeer').click(function(){
        var name = $('#newBeerName').val();
        var imgurl = $('#newBeerImage').val();
        var website = $('#newBeerWebsite').val();
        $.ajax({
            url: 'http://5c2605d6.ngrok.com/beer/create/?name='+name+'&imgurl='+imgurl+'&website='+website,
            type: 'get',
            async: false,
            success: function(data) {
                console.log(data);
                $('#newBeerAdded').fadeIn();
                $('#newBeerName').val('');
                $('#newBeerImage').val('');
                $('#newBeerWebsite').val('');
            },
            error: function(data){
                $('#newBeerFailed').fadeIn();
                $('#newBeerName').val('');
                $('#newBeerImage').val('');
                $('#newBeerWebsite').val('');
            } 
        });    
    });

    //Update Beers!
    $('#updateTechBeer').click(function(){
        removeCurrentBeer("tech");
        var beerID = $('#techBeerOptions').children(":selected").attr("id");
        $.ajax({
            url: 'http://5c2605d6.ngrok.com/beer/update/'+beerID+'?currentTechBeer=true',
            type: 'get',
            async: false,
            success: function(data) {
                $('#techBeerUpdated').fadeIn();
            } 
        });
    });
    $('#updateEditBeer').click(function(){
        removeCurrentBeer("edit");
        var beerID = $('#editBeerOptions').children(":selected").attr("id");
        $.ajax({
            url: 'http://5c2605d6.ngrok.com/beer/update/'+beerID+'?currentEditBeer=true',
            type: 'get',
            async: false,
            success: function(data) {
                $('#editBeerUpdated').fadeIn();
            } 
        });
    });

    //Remove the current beer to make way for the new one to get set
    function removeCurrentBeer(floor){
        var i = 0;
        while(i < beers.length){
            if (floor == "tech" && beers[i].currentTechBeer == "true"){
                setCurrentToFalse(floor, beers[i].id);
            }
            else if(floor == "edit" && beers[i].currentEditBeer == "true"){
                setCurrentToFalse(floor, beers[i].id);
            }
            i++;
        }
        function setCurrentToFalse(floor, currentBeerID){
            var updateURL = "";

            if (floor == "tech"){
                updateURL = 'http://5c2605d6.ngrok.com/beer/update/'+currentBeerID+'?currentTechBeer=false';
            }

            else if (floor == "edit"){
                updateURL = 'http://5c2605d6.ngrok.com/beer/update/'+currentBeerID+'?currentEditBeer=false';
            }

            $.ajax({
                url: updateURL,
                type: 'get',
                async: false,
                success: function(data) {
                    console.log(data);
                } 
            });
        }
    }

    //sorts in alphabetical order
    function compare(a,b) {
      if (a.name < b.name)
         return -1;
      if (a.name > b.name)
        return 1;
      return 0;
    }

    // Closes the sidebar menu
    $("#menu-close").click(function(e) {
        e.preventDefault();
        $("#sidebar-wrapper").toggleClass("active");
    });

    // Opens the sidebar menu
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#sidebar-wrapper").toggleClass("active");
    });

    // Scrolls to the selected menu item on the page
    $(function() {
        $('a[href*=#]:not([href=#])').click(function() {
            if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') || location.hostname == this.hostname) {

                var target = $(this.hash);
                target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
                if (target.length) {
                    $('html,body').animate({
                        scrollTop: target.offset().top
                    }, 1000);
                    return false;
                }
            }
        });
    });
    </script>

</body>

</html>
